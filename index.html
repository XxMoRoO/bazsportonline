<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baz Sport</title>
    <!-- Local Libraries -->
    <script src="libs/tailwindcss.js"></script>
    <script src="libs/jsbarcode.all.min.js"></script>
    <script src="libs/jspdf.umd.min.js"></script>
    <script src="libs/jspdf.plugin.autotable.min.js"></script>
    <script src="libs/xlsx.full.min.js"></script>
    <style>
        /* [--- إضافة ---] استدعاء الخطوط المحلية */
        @font-face {
            font-family: 'Poppins';
            src: url('./fonts/Poppins-Regular.ttf') format('truetype');
            font-weight: 400;
        }

        @font-face {
            font-family: 'Poppins';
            src: url('./fonts/Poppins-SemiBold.ttf') format('truetype');
            font-weight: 600;
        }

        @font-face {
            font-family: 'Tajawal';
            src: url('./fonts/Tajawal-Regular.ttf') format('truetype');
            font-weight: 400;
        }

        @font-face {
            font-family: 'Tajawal';
            src: url('./fonts/Tajawal-Bold.ttf') format('truetype');
            font-weight: 700;
        }

        :root {
            --primary-bg: #111827;
            /* Gray 900 */
            --secondary-bg: #1F2937;
            /* Gray 800 */
            --primary-text: #F9FAFB;
            /* Gray 50 */
            --header-bg: #0f172a;
            /* Slate 900 */
            --accent-color: #3B82F6;
            /* Blue 500 */
            --highlight-color: #60A5FA;
            /* Blue 400 */
            --success-color: #10B981;
            /* Emerald 500 */
            --danger-color: #EF4444;
            /* Red 500 */
            --danger-hover-color: #DC2626;
            /* Red 600 */
            --net-profit-color: #34D399;
            /* Emerald 400 */
            --expense-color: #F87171;
            /* Red 400 */
            /* [--- إضافة ---] ألوان النيون الجديدة */
            --neon-green: #39FF14;
            --neon-yellow: #FFFF00;
        }

        body {
            /* [--- تعديل ---] تطبيق الخط الإنجليزي */
            font-family: 'Poppins', sans-serif;
            background-color: var(--primary-bg);
            color: var(--primary-text);
        }

        /* [--- تعديل ---] تطبيق الخط العربي */
        body[dir="rtl"] {
            font-family: 'Tajawal', sans-serif;
        }

        ::-webkit-scrollbar {
            display: none;
        }

        body {
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .hidden {
            display: none !important;
        }

        header {
            background-color: var(--header-bg);
            border-bottom: 1px solid var(--secondary-bg);
        }

        .modal {
            background-color: rgba(0, 0, 0, 0.6);
        }

        .modal-content {
            background-color: var(--secondary-bg);
            color: var(--primary-text);
        }

        .modal-content-scrollable {
            max-height: 85vh;
            overflow-y: auto;
        }

        body:not(.admin-mode) .admin-only,
        body:not(.admin-mode) .admin-only-block {
            display: none;
        }

        body.admin-mode .admin-only {
            display: flex;
        }

        body.admin-mode .admin-only-block {
            display: block;
        }

        .btn-primary {
            background-color: var(--accent-color);
            color: white;
            transition: background-color 0.3s;
            font-weight: 600;
        }

        .btn-primary:hover {
            background-color: var(--highlight-color);
        }

        .btn-primary.added {
            background-color: var(--success-color);
            animation: vibrate 0.3s linear;
        }

        /* [--- إضافة ---] تنسيقات جديدة للأزرار الأيقونية */
        .btn-icon {
            background-color: #4B5563;
            /* Gray 600 */
            color: var(--primary-text);
            transition: all 0.2s ease-in-out;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.5rem;
        }

        .btn-icon:hover {
            background-color: #6B7280;
            /* Gray 500 */
            transform: translateY(-1px);
        }

        .btn-icon svg {
            width: 20px;
            height: 20px;
        }

        /* [--- إضافة ---] تنسيقات النيون الجديدة */
        .btn-icon-green {
            background-color: rgba(57, 255, 20, 0.1);
            border: 1px solid rgba(57, 255, 20, 0.3);
        }

        .btn-icon-green:hover {
            background-color: rgba(57, 255, 20, 0.2);
        }

        .btn-icon-green svg {
            color: var(--neon-green);
            filter: drop-shadow(0 0 3px var(--neon-green)) drop-shadow(0 0 5px var(--neon-green));
        }

        .btn-icon-yellow {
            background-color: rgba(255, 255, 0, 0.1);
            border: 1px solid rgba(255, 255, 0, 0.3);
        }

        .btn-icon-yellow:hover {
            background-color: rgba(255, 255, 0, 0.2);
        }

        .btn-icon-yellow svg {
            color: var(--neon-yellow);
            filter: drop-shadow(0 0 3px var(--neon-yellow)) drop-shadow(0 0 5px var(--neon-yellow));
        }


        .btn-secondary {
            background-color: #4B5563;
            /* Gray 600 */
            color: var(--primary-text);
            transition: background-color 0.3s;
            font-weight: 600;
        }

        .btn-secondary:hover {
            background-color: #6B7280;
            /* Gray 500 */
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
            transition: background-color 0.3s;
        }

        .btn-danger:hover {
            background-color: var(--danger-hover-color);
        }

        .nav-link {
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.5rem;
            transition: all 0.3s ease-in-out;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 70px;
            height: 60px;
            color: #9CA3AF;
            /* Gray 400 */
        }

        .nav-link:hover:not(.active) {
            background-color: var(--secondary-bg);
            color: var(--accent-color);
            transform: translateY(-2px);
        }

        .nav-link.active {
            background-color: var(--accent-color);
            color: white;
        }

        #admin-mode-btn.active {
            background-color: var(--success-color);
            color: white;
        }

        .icon-wrapper {
            width: 1.7rem;
            height: 1.7rem;
            margin-bottom: 2px;
            position: relative;
        }

        .nav-link .nav-text-label {
            font-size: 0.65rem;
            line-height: 1;
            white-space: nowrap;
            font-weight: 600;
        }

        .nav-selling-wrapper {
            position: relative;
        }

        #cart-item-count {
            position: absolute;
            top: -5px;
            right: -8px;
            background-color: var(--danger-color);
            color: white;
            font-size: 0.7rem;
            font-weight: bold;
            border-radius: 9999px;
            height: 20px;
            width: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid var(--header-bg);
        }

        .category-tab,
        .supplier-tab {
            padding: 8px 16px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
            font-weight: 600;
            color: #9CA3AF;
            /* Gray 400 */
        }

        .category-tab.active,
        .supplier-tab.active {
            color: var(--accent-color);
            border-bottom-color: var(--accent-color);
        }

        .sale-card-selected {
            background-color: var(--secondary-bg) !important;
            border: 1px solid var(--highlight-color);
        }

        /* [--- تعديل ---] تم إضافة textarea هنا */
        input,
        select,
        textarea {
            background-color: #374151;
            /* Gray 700 */
            border: 1px solid #4B5563;
            /* Gray 600 */
            color: var(--primary-text);
        }

        /* [--- تعديل ---] تصغير حجم حقول الإدخال في الفلاتر */
        .filter-control {
            padding: 0.5rem;
            font-size: 0.875rem;
            border-radius: 0.5rem;
        }


        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--highlight-color);
            box-shadow: 0 0 0 2px rgba(96, 165, 250, 0.3);
        }

        .payment-method-btn {
            background-color: var(--secondary-bg);
            border: 2px solid #4B5563;
            /* Gray 600 */
            transition: all 0.2s ease-in-out;
            font-weight: 600;
        }

        .payment-method-btn.selected,
        .payment-method-btn:hover {
            background-color: var(--primary-bg);
            border-color: var(--highlight-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            color: var(--accent-color);
        }

        .receipt-tab {
            position: relative;
            padding: 0.5rem;
            cursor: pointer;
            background-color: var(--secondary-bg);
            border: 1px solid #4B5563;
            /* Gray 600 */
            border-bottom: none;
            border-radius: 0.5rem 0.5rem 0 0;
            margin-right: 2px;
            transition: all 0.2s ease-in-out;
            transform-origin: bottom left;
        }

        .receipt-tab.active {
            background-color: var(--primary-bg);
            color: var(--accent-color);
            border-top: 3px solid var(--accent-color);
            transform: translateY(2px) scale(1);
        }

        .receipt-tab:not(.active) {
            transform: scale(0.7);
        }

        .receipt-tab:not(.active):hover {
            transform: scale(1);
        }

        .receipt-tab .tab-content {
            display: flex;
            align-items: center;
        }

        .receipt-tab:not(.active) .tab-full-text {
            display: none;
        }

        .receipt-tab:not(.active):hover .tab-full-text {
            display: inline;
        }

        .receipt-tab:not(.active):hover .tab-short-text {
            display: none;
        }

        .receipt-tab .close-receipt-btn {
            margin-left: 0.5rem;
            padding: 0.1rem;
            border-radius: 9999px;
            display: none;
        }

        .receipt-tab.active .close-receipt-btn,
        .receipt-tab:hover .close-receipt-btn {
            display: inline-block;
        }

        .receipt-tab .close-receipt-btn:hover {
            background-color: var(--danger-color);
            color: white;
        }

        #add-receipt-btn {
            background-color: transparent;
            border: 2px dashed #4B5563;
            /* Gray 600 */
            color: #9CA3AF;
            /* Gray 400 */
            transition: all 0.2s ease-in-out;
        }

        #add-receipt-btn:hover {
            background-color: var(--secondary-bg);
            color: var(--accent-color);
        }

        .color-swatch {
            width: 28px;
            height: 28px;
            border-radius: 9999px;
            border: 2px solid #4B5563;
            /* Gray 600 */
            cursor: pointer;
            transition: all 0.2s;
        }

        .color-swatch.active {
            border-color: var(--accent-color);
            transform: scale(1.1);
        }

        .color-swatch:hover:not(.active) {
            border-color: var(--highlight-color);
        }

        .product-card,
        #active-receipt-content,
        .bg-secondary-bg {
            background-color: var(--secondary-bg) !important;
            color: var(--primary-text);
        }

        .product-card {
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .product-card-image-wrapper {
            position: relative;
            width: 100%;
            aspect-ratio: 1 / 1;
            margin-bottom: 1rem;
        }

        .product-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.7s;
            transform-style: preserve-3d;
        }

        .product-card:hover .product-card-inner {
            transform: rotateY(180deg);
        }

        .product-card-front,
        .product-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
        }

        .product-card-back {
            transform: rotateY(180deg);
        }

        .product-card-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 0.375rem;
        }

        .paid-salary-row {
            background-color: #064E3B !important;
            /* Emerald 900 */
            color: #A7F3D0 !important;
            /* Emerald 200 */
        }

        .paid-salary-row input {
            background-color: #047857 !important;
            /* Emerald 700 */
            color: #A7F3D0 !important;
            /* Emerald 200 */
            border-color: #34D399 !important;
            /* Emerald 400 */
        }

        #loader-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(17, 24, 39, 0.8);
            /* Gray 900 with opacity */
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .loader-spinner {
            width: 56px;
            height: 56px;
            border: 6px solid var(--secondary-bg);
            border-bottom-color: var(--accent-color);
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }

        @keyframes rotation {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        @keyframes vibrate {
            0% {
                transform: translate(0);
            }

            20% {
                transform: translate(-1px, 1px);
            }

            40% {
                transform: translate(-1px, -1px);
            }

            60% {
                transform: translate(1px, 1px);
            }

            80% {
                transform: translate(1px, -1px);
            }

            100% {
                transform: translate(0);
            }
        }
    </style>
</head>

<body class="antialiased">

    <header class="p-4 flex justify-between items-center sticky top-0 z-40">
        <div class="flex-1 flex justify-start">
            <div id="home-btn" class="flex items-center space-x-3 cursor-pointer">
                <img id="header-logo" src="../build/logo.png" alt="Baz Sport Logo" class="h-11 w-11">
                <span class="text-2xl font-bold" style="color: var(--primary-text);">Baz Sport</span>
            </div>
        </div>

        <nav class="flex-shrink-0 flex items-center justify-center space-x-1 md:space-x-2">
            <button id="nav-home" class="nav-link active" data-page="home-page" title="Home">
                <div class="icon-wrapper">
                    <svg class="icon" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" />
                    </svg>
                </div>
                <span class="nav-text-label" data-lang-key="navHome">Home</span>
            </button>

            <button id="nav-inventory" class="nav-link admin-only" data-page="inventory-page" title="Inventory">
                <div class="icon-wrapper">
                    <svg class="icon" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M2,8.5L12,13.5L22,8.5L12,3.5L2,8.5Z M12,14.5L2,9.5V15.5L12,20.5L22,15.5V9.5L12,14.5Z" />
                    </svg>
                </div>
                <span class="nav-text-label" data-lang-key="navInventory">Inventory</span>
            </button>

            <button id="nav-selling" class="nav-link" data-page="selling-page" title="Selling">
                <div class="nav-selling-wrapper icon-wrapper">
                    <svg class="icon" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z" />
                    </svg>
                    <span id="cart-item-count" class="hidden">0</span>
                </div>
                <span class="nav-text-label" data-lang-key="navSelling">Selling</span>
            </button>

            <button id="nav-booking" class="nav-link" data-page="booking-page" title="Booking">
                <div class="icon-wrapper">
                    <svg class="icon" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M19,4H18V2H16V4H8V2H6V4H5A2,2 0 0,0 3,6V20A2,2 0 0,0 5,22H19A2,2 0 0,0 21,20V6A2,2 0 0,0 19,4M19,20H5V10H19V20M19,8H5V6H19V8Z" />
                    </svg>
                </div>
                <span class="nav-text-label" data-lang-key="navBooking">Booking</span>
            </button>

            <button id="nav-best-sellers" class="nav-link admin-only" data-page="best-sellers-page"
                title="Best Sellers">
                <div class="icon-wrapper">
                    <svg class="icon" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z" />
                    </svg>
                </div>
                <span class="nav-text-label" data-lang-key="navBestSellers">Best Sellers</span>
            </button>

            <button id="nav-defects" class="nav-link admin-only" data-page="defects-page" title="Defects">
                <div class="icon-wrapper">
                    <svg class="icon" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" />
                    </svg>
                </div>
                <span class="nav-text-label" data-lang-key="navDefects">Defects</span>
            </button>

            <button id="nav-salaries" class="nav-link admin-only" data-page="salaries-page" title="Salaries">
                <div class="icon-wrapper">
                    <svg class="icon" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z" />
                    </svg>
                </div>
                <span class="nav-text-label" data-lang-key="navSalaries">Salaries</span>
            </button>
            <button id="nav-customers" class="nav-link admin-only" data-page="customers-page" title="Customers">
                <div class="icon-wrapper">
                    <svg class="icon" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z" />
                    </svg>
                </div>
                <span class="nav-text-label" data-lang-key="navCustomers">Customers</span>
            </button>
            <button id="nav-suppliers" class="nav-link admin-only" data-page="suppliers-page" title="Suppliers">
                <div class="icon-wrapper">
                    <svg class="icon" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M16 12h2v4h-2v-4m-4 0h2v4h-2v-4m-4 0h2v4H8v-4m12-5H4v11H2V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v2h-2V5Z" />
                    </svg>
                </div>
                <span class="nav-text-label" data-lang-key="navSuppliers">Suppliers</span>
            </button>

            <!-- [--- تعديل ---] تم تغيير ترتيب الأزرار -->
            <button id="nav-shifts" class="nav-link admin-only" data-page="shifts-page" title="Shifts">
                <div class="icon-wrapper">
                    <svg class="icon" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M11.5,2C15.09,2 18,4.91 18,8.5C18,12.09 15.09,15 11.5,15C7.91,15 5,12.09 5,8.5C5,4.91 7.91,2 11.5,2M11.5,4C9,4 7,6 7,8.5C7,11 9,13 11.5,13C14,13 16,11 16,8.5C16,6 14,4 11.5,4M11.5,16C9.17,16 4.67,17.17 4.67,19.5V22H18.33V19.5C18.33,17.17 13.83,16 11.5,16Z" />
                    </svg>
                </div>
                <span class="nav-text-label" data-lang-key="navShifts">Shifts</span>
            </button>
            <button id="nav-history" class="nav-link admin-only" data-page="history-page" title="History">
                <div class="icon-wrapper">
                    <svg class="icon" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7v2c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.25 2.52.75-1.23-3.5-2.07V8H12z" />
                    </svg>
                </div>
                <span class="nav-text-label" data-lang-key="navHistory">History</span>
            </button>

            <button id="admin-mode-btn" class="nav-link">
                <div class="icon-wrapper">
                    <svg class="icon" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z" />
                    </svg>
                </div>
                <span class="nav-text-label" data-lang-key="navAdminMode">Admin</span>
            </button>
        </nav>

        <div class="flex-1 flex justify-end items-center space-x-2">
            <!-- [--- إضافة ---] زر الإعدادات الجديد -->
            <button id="nav-settings" class="nav-link admin-only" data-page="settings-page" title="Settings">
                <div class="icon-wrapper">
                    <svg class="icon" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.08-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.08.49 0 .61.22l2-3.46c.12-.22.07.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z" />
                    </svg>
                </div>
                <span class="nav-text-label" data-lang-key="navSettings">Settings</span>
            </button>
            <button id="lang-switcher" class="nav-link" title="Switch Language">
                <div class="icon-wrapper">
                    <svg class="icon" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95a15.65 15.65 0 00-1.38-3.39A8.04 8.04 0 0118.92 8zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.39A7.99 7.99 0 015.08 16zm2.95-8H5.08a7.99 7.99 0 014.21-3.39c-.6 1.05-1.06 2.14-1.38 3.39zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2s.07-1.35.16-2h4.68c.09.65.16 1.32.16 2s-.07 1.34-.16 2zm.25 5.39c.6-1.05 1.06-2.14 1.38-3.39h2.95a8.04 8.04 0 01-4.33 3.39zM16.38 14c.08-.66.14-1.32.14-2s-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z" />
                    </svg>
                </div>
                <span id="lang-switcher-text" class="nav-text-label"></span>
            </button>
            <button id="logout-btn" class="nav-link" title="Logout">
                <div class="icon-wrapper">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M14 8V6C14 4.89543 13.1046 4 12 4H8C6.89543 4 6 4.89543 6 6V18C6 19.1046 6.89543 20 8 20H12C13.1046 20 14 19.1046 14 18V16"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        <path d="M10 12H20M20 12L17 9M20 12L17 15" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </div>
            </button>
        </div>
    </header>

    <main id="app-container" class="p-4 md:p-8">
        <!-- Home Page -->
        <div id="home-page" class="page">
            <div class="flex justify-between items-center mb-4">
                <input type="text" id="product-search" class="w-full max-w-md p-2 rounded-lg"
                    data-lang-key="searchPlaceholder" placeholder="Search...">
                <div id="home-category-tabs" class="flex items-center space-x-2"></div>
            </div>
            <div id="product-gallery" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6"></div>
        </div>

        <!-- Inventory Page -->
        <div id="inventory-page" class="page hidden">
            <div class="flex justify-between items-center mb-4">
                <h1 class="text-3xl font-bold" data-lang-key="navInventory">Inventory</h1>
                <div class="flex items-center space-x-2">
                    <button id="add-product-btn" class="btn-primary py-2 px-4 rounded-lg"
                        data-lang-key="addNewProduct">Add Product</button>
                    <button id="manage-categories-btn" class="btn-secondary py-2 px-4 rounded-lg"
                        data-lang-key="manageCategories">Manage Categories</button>
                    <button id="export-inventory-btn" class="btn-secondary py-2 px-4 rounded-lg"
                        data-lang-key="exportInventory">Export Report</button>
                </div>
            </div>
            <div class="flex justify-between items-center mb-4">
                <input type="text" id="inventory-search" class="w-full max-w-md p-2 rounded-lg"
                    data-lang-key="inventorySearchPlaceholder" placeholder="Search inventory...">
                <div id="inventory-category-tabs" class="flex items-center space-x-2"></div>
            </div>
            <div class="overflow-x-auto bg-secondary-bg rounded-lg shadow">
                <table id="inventory-table" class="w-full text-sm text-left">
                    <thead class="text-xs uppercase" style="background-color: var(--header-bg);">
                        <tr>
                            <th class="p-2" data-lang-key="colProductName">Name</th>
                            <th class="p-2" data-lang-key="colProductCode">Code</th>
                            <th class="p-2" data-lang-key="colCategory">Category</th>
                            <th class="p-2" data-lang-key="colImage">Image</th>
                            <th class="p-2" data-lang-key="colQuantity">Quantity</th>
                            <th class="p-2" data-lang-key="colPurchasePrice">Purchase Price</th>
                            <th class="p-2" data-lang-key="colSellingPrice">Selling Price</th>
                            <th class="p-2" data-lang-key="colActions">Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Selling Page -->
        <div id="selling-page" class="page hidden">
            <div id="receipt-tabs-container" class="flex items-end -mb-px"></div>
            <div id="active-receipt-content" class="p-6 rounded-b-lg rounded-r-lg"
                style="background-color: var(--primary-bg); border: 1px solid #4B5563;"></div>
        </div>

        <!-- Booking Page -->
        <div id="booking-page" class="page hidden">
            <div class="flex justify-between items-center mb-4">
                <h1 class="text-3xl font-bold" data-lang-key="openBookings">Open Bookings</h1>
                <input type="text" id="booking-search-input" class="w-full max-w-md p-2 rounded-lg"
                    data-lang-key="bookingSearchPlaceholder" placeholder="Search...">
            </div>
            <div id="open-bookings-list" class="space-y-4"></div>
        </div>

        <!-- [--- تعديل ---] تم تحديث هيكل صفحة اليوميات -->
        <div id="shifts-page" class="page hidden">
            <div class="flex justify-between items-center mb-6">
                <h1 class="text-3xl font-bold" data-lang-key="navShifts">Shifts</h1>
                <div class="flex items-center space-x-2">
                    <button id="add-daily-expense-btn" class="btn-secondary py-2 px-4 rounded-lg"
                        data-lang-key="addDailyExpense">Add Daily Expense</button>
                    <button id="calculate-shift-btn" class="btn-primary py-2 px-4 rounded-lg"
                        data-lang-key="calculateCurrentShift">Calculate Current Shift</button>
                </div>
            </div>
            <div>
                <h2 class="text-2xl font-bold mb-4" data-lang-key="shiftHistory">Shift History</h2>
                <div id="shift-history-container" class="space-y-4">
                    <!-- Shift history will be rendered here by ui.js -->
                </div>
            </div>
        </div>


        <!-- Best Sellers Page -->
        <div id="best-sellers-page" class="page hidden">
            <div class="bg-secondary-bg p-6 rounded-lg shadow mb-6">
                <h2 class="text-2xl font-bold mb-4" data-lang-key="navBestSellers">Best Sellers</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end" id="best-sellers-filters">
                    <div>
                        <label for="bs-time-filter-type" class="block text-sm mb-1" data-lang-key="timeFilter">Time
                            Filter</label>
                        <select id="bs-time-filter-type" class="w-full p-2 rounded-lg">
                            <option value="all" data-lang-key="allTime">All Time</option>
                            <option value="month" data-lang-key="byMonth">By Month</option>
                            <option value="day" data-lang-key="byDay">By Day</option>
                        </select>
                    </div>
                    <div id="bs-month-filter-container" class="hidden">
                        <label for="bs-report-month-picker" class="block text-sm mb-1"
                            data-lang-key="selectMonth">Select Month</label>
                        <input type="month" id="bs-report-month-picker" class="w-full p-2 rounded-lg">
                    </div>
                    <div id="bs-day-filter-container" class="hidden">
                        <label for="bs-report-day-picker" class="block text-sm mb-1" data-lang-key="selectDay">Select
                            Day</label>
                        <input type="date" id="bs-report-day-picker" class="w-full p-2 rounded-lg">
                    </div>
                </div>
            </div>
            <div id="best-sellers-list" class="space-y-4"></div>
        </div>

        <!-- Defects Page -->
        <div id="defects-page" class="page hidden">
            <h1 class="text-3xl font-bold mb-4" data-lang-key="navDefects">Defective Items</h1>
            <div class="bg-secondary-bg p-4 rounded-lg shadow mb-4">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end">
                    <div>
                        <label for="defects-month-picker" class="block text-sm mb-1" data-lang-key="selectMonth">Filter
                            by Month</label>
                        <input type="month" id="defects-month-picker" class="w-full p-2 rounded-lg">
                    </div>
                    <div>
                        <label for="defects-day-picker" class="block text-sm mb-1" data-lang-key="selectDay">Filter by
                            Day</label>
                        <input type="date" id="defects-day-picker" class="w-full p-2 rounded-lg">
                    </div>
                    <div>
                        <label for="defects-search" class="block text-sm mb-1" data-lang-key="searchPlaceholder">Search
                            by Name</label>
                        <input type="text" id="defects-search" class="w-full p-2 rounded-lg" placeholder="Search...">
                    </div>
                </div>
            </div>
            <div class="overflow-x-auto bg-secondary-bg rounded-lg shadow">
                <table id="defects-table" class="w-full text-sm text-left">
                    <thead class="text-xs uppercase" style="background-color: var(--header-bg);">
                        <tr>
                            <th class="p-4" data-lang-key="colProductName">Product</th>
                            <th class="p-4" data-lang-key="colColors">Color / Size</th>
                            <th class="p-4" data-lang-key="colQuantity">Quantity</th>
                            <th class="p-4" data-lang-key="colDefectDate">Defect Date</th>
                            <th class="p-4" data-lang-key="colDefectReason">Reason</th>
                            <th class="p-4" data-lang-key="colPurchasePrice">Cost</th>
                            <th class="p-4" data-lang-key="colReturnStatusToSupplier">Return Status</th>
                            <th class="p-4" data-lang-key="colActions">Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- History Page -->
        <div id="history-page" class="page hidden">
            <div class="bg-secondary-bg p-4 rounded-lg shadow mb-6">
                <h2 class="text-2xl font-bold mb-4" data-lang-key="reports">Reports</h2>
                <div id="report-filters" class="flex flex-wrap items-end gap-x-4 gap-y-2">
                    <div class="flex-grow min-w-[150px]">
                        <label for="time-filter-type" class="block text-xs mb-1" data-lang-key="timeFilter">Time
                            Filter</label>
                        <select id="time-filter-type" class="w-full filter-control">
                            <option value="all" data-lang-key="allTime">All Time</option>
                            <option value="month" data-lang-key="byMonth">By Month</option>
                            <option value="day" data-lang-key="byDay">By Day</option>
                        </select>
                    </div>
                    <div id="month-filter-container" class="hidden flex-grow min-w-[150px]">
                        <label for="report-month-picker" class="block text-xs mb-1" data-lang-key="selectMonth">Select
                            Month</label>
                        <input type="month" id="report-month-picker" class="w-full filter-control">
                    </div>
                    <div id="day-filter-container" class="hidden flex-grow min-w-[150px]">
                        <label for="report-day-picker" class="block text-xs mb-1" data-lang-key="selectDay">Select
                            Day</label>
                        <input type="date" id="report-day-picker" class="w-full filter-control">
                    </div>
                    <div class="flex-grow min-w-[150px]">
                        <label for="user-filter" class="block text-xs mb-1" data-lang-key="cashier">Cashier</label>
                        <select id="user-filter" class="w-full filter-control">
                            <option value="all" data-lang-key="allUsers">All Users</option>
                        </select>
                    </div>
                    <div class="flex items-center space-x-2">
                        <!-- [--- تعديل ---] تم تغيير أيقونة تصدير المبيعات وتنسيقها -->
                        <button id="export-pdf-btn" class="btn-icon btn-icon-green" title="Export Sales to PDF"
                            data-lang-key="exportPdf">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zM12 18c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm-1-4h2v-1h-1c-.55 0-1-.45-1-1s.45-1 1-1h1v-1h-2v1h1c.55 0 1 .45 1 1s-.45 1-1 1h-1v1z" />
                            </svg>
                        </button>
                        <!-- [--- تعديل ---] تم تغيير أيقونة تصدير المرتجعات وتنسيقها -->
                        <button id="export-returns-pdf-btn" class="btn-icon btn-icon-yellow"
                            title="Export Returns to PDF" data-lang-key="exportReturns">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zM13 9V3.5L18.5 9H13zm-1 8.5c-2.49 0-4.5-2.01-4.5-4.5S9.51 8.5 12 8.5c1.34 0 2.54.58 3.36 1.5l-1.43 1.43C13.55 10.59 12.83 10 12 10c-1.66 0-3 1.34-3 3s1.34 3 3 3c.99 0 1.84-.48 2.37-1.22l1.43 1.43C14.83 17.43 13.5 18 12 18z" />
                            </svg>
                        </button>
                    </div>
                </div>

                <div id="report-summary"
                    class="mt-6 border-t border-gray-700 pt-4 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                    <!-- Summary content will be rendered here -->
                </div>
            </div>
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold" data-lang-key="salesHistory">Sales History</h2>
                <input type="text" id="history-search" data-lang-key="searchReceiptsPlaceholder" placeholder="Search..."
                    class="p-2 rounded-lg">
            </div>
            <div id="selection-controls" class="flex items-center space-x-4 mb-4 hidden">
                <input type="checkbox" id="select-all-checkbox" class="h-5 w-5 rounded"><label for="select-all-checkbox"
                    data-lang-key="selectAll">Select All</label>
                <button id="delete-selected-btn" class="btn-danger py-2 px-4 rounded-lg hidden"
                    data-lang-key="deleteSelected">Delete Selected</button>
            </div>
            <div id="sales-history-list" class="space-y-4"></div>
        </div>

        <!-- Salaries Page -->
        <div id="salaries-page" class="page hidden">
            <div class="flex justify-between items-center mb-4">
                <h1 class="text-3xl font-bold" data-lang-key="navSalaries">Salaries</h1>
                <div class="flex items-center space-x-2">
                    <input type="month" id="salaries-month-picker" class="p-2 rounded-lg">
                    <input type="text" id="salaries-search-input" placeholder="Search for user..."
                        class="p-2 rounded-lg">
                    <button id="open-users-window-btn" class="btn-secondary py-2 px-4 rounded-lg"
                        data-lang-key="userManagement">User Management</button>
                    <button id="add-employee-btn" class="btn-primary py-2 px-4 rounded-lg"
                        data-lang-key="addEmployee">Add Employee</button>
                    <button id="export-salaries-btn" class="btn-primary py-2 px-4 rounded-lg"
                        data-lang-key="exportExcel">Export to Excel</button>
                </div>
            </div>
            <div class="bg-secondary-bg p-4 rounded-lg shadow mb-6">
                <h2 class="text-xl font-bold mb-2" data-lang-key="rent">Monthly Rent</h2>
                <div class="flex items-center space-x-4">
                    <div>
                        <label for="rent-amount-input" class="block text-sm">Rent Amount (EGP)</label>
                        <input type="number" id="rent-amount-input" class="p-2 rounded-lg" min="0">
                    </div>
                    <div class="self-end">
                        <button id="toggle-rent-paid-btn"
                            class="py-2 px-4 rounded-lg text-white text-sm">Unpaid</button>
                    </div>
                </div>
            </div>
            <div class="overflow-x-auto bg-secondary-bg rounded-lg shadow">
                <table id="salaries-table" class="w-full text-sm text-left">
                    <thead class="text-xs uppercase" style="background-color: var(--header-bg);">
                        <tr>
                            <th class="p-4" data-lang-key="colEmployeeId">Employee ID</th>
                            <th class="p-4" data-lang-key="colUserName">User Name</th>
                            <th class="p-4" data-lang-key="colCustomerPhone">Phone</th>
                            <th class="p-4" data-lang-key="colFixedSalary">Fixed Salary</th>
                            <th class="p-4" data-lang-key="colCommissionPerPiece">Commission / Piece</th>
                            <th class="p-4" data-lang-key="colBonus">Bonus</th>
                            <th class="p-4" data-lang-key="colPiecesSold">Pieces Sold</th>
                            <th class="p-4" data-lang-key="colTotalCommission">Total Commission</th>
                            <th class="p-4" data-lang-key="colTotalSalary">Total Salary</th>
                            <th class="p-4">Paid Status</th>
                            <th class="p-4" data-lang-key="colActions">Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Customers Page -->
        <div id="customers-page" class="page hidden">
            <h1 class="text-3xl font-bold mb-4" data-lang-key="customersTitle">Customers</h1>
            <div class="bg-secondary-bg p-4 rounded-lg shadow mb-4 flex justify-between items-center">
                <input type="text" id="customer-search" placeholder="Search by name or phone..." class="p-2 rounded-lg">
                <div>
                    <button id="add-customer-btn" class="btn-primary py-2 px-4 rounded-lg mr-2">Add Customer</button>
                    <button id="export-customers-btn" class="btn-secondary py-2 px-4 rounded-lg"
                        data-lang-key="exportExcel">Export to Excel</button>
                </div>
            </div>
            <div class="overflow-x-auto bg-secondary-bg rounded-lg shadow">
                <table id="customers-table" class="w-full text-sm text-left">
                    <thead class="text-xs uppercase" style="background-color: var(--header-bg);">
                        <tr>
                            <th class="p-4" data-lang-key="colCustomerName">Name</th>
                            <th class="p-4" data-lang-key="colCustomerPhone">Phone</th>
                            <th class="p-4" data-lang-key="colCustomerAddress">Address</th>
                            <th class="p-4" data-lang-key="colCustomerCity">City</th>
                            <th class="p-4" data-lang-key="colTotalItems">Items Bought</th>
                            <th class="p-4" data-lang-key="colLastPurchase">Last Purchase</th>
                            <th class="p-4" data-lang-key="colActions">Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Suppliers Page -->
        <div id="suppliers-page" class="page hidden">
            <!-- Content will be rendered by JS -->
        </div>

        <!-- [--- إضافة ---] صفحة الإعدادات الجديدة -->
        <div id="settings-page" class="page hidden">
            <h1 class="text-3xl font-bold mb-6" data-lang-key="settingsTitle">Application Settings</h1>

            <div class="bg-secondary-bg p-6 rounded-lg shadow">
                <h2 class="text-2xl font-bold mb-4" data-lang-key="backupAndRestore">Backup & Restore</h2>
                <div class="flex items-center space-x-4">
                    <button id="backup-db-btn" class="btn-primary py-2 px-4 rounded-lg" data-lang-key="backupBtn">Backup
                        Database</button>
                    <button id="restore-db-btn" class="btn-danger py-2 px-4 rounded-lg"
                        data-lang-key="restoreBtn">Restore Database</button>
                </div>
            </div>
        </div>

    </main>

    <!-- Modals -->
    <div id="product-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-content modal-content-scrollable w-full max-w-2xl p-6 rounded-lg shadow-lg my-8"></div>
    </div>
    <div id="barcode-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden"></div>
    <div id="category-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-content w-full max-w-md p-6 rounded-lg shadow-lg"></div>
    </div>
    <div id="receipt-selection-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden"></div>
    <div id="return-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-content w-full max-w-md p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-bold mb-4" id="return-modal-title">Return Items</h2>
            <div id="return-items-container" class="space-y-2 max-h-60 overflow-y-auto mb-4"></div>
            <div class="border-t border-gray-600 pt-4">
                <label for="return-delivery-fee-input" class="block mb-1" data-lang-key="returnDeliveryFee">Return
                    Shipping Fee (Expense)</label>
                <input type="number" id="return-delivery-fee-input" class="w-full p-2 rounded-lg" min="0"
                    placeholder="0.00">
            </div>
            <div class="flex justify-end space-x-4 mt-6">
                <button id="cancel-return-btn" class="btn-secondary py-2 px-4 rounded-lg">Cancel</button>
                <button id="confirm-return-btn" class="btn-primary py-2 px-4 rounded-lg">Confirm Return</button>
            </div>
        </div>
    </div>
    <div id="admin-password-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-content w-full max-w-sm p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-bold mb-4">Admin Login</h2>
            <form id="admin-password-form">
                <label for="admin-password-input" class="block mb-2">Password</label>
                <input type="password" id="admin-password-input" class="w-full p-2 rounded-lg mb-2" required>
                <p id="admin-password-error" class="text-red-500 text-sm mb-4 hidden">Incorrect password.</p>
                <div class="flex justify-end space-x-4 mt-4">
                    <button type="button" id="cancel-admin-password-btn"
                        class="btn-secondary py-2 px-4 rounded-lg">Cancel</button>
                    <button type="submit" class="btn-primary py-2 px-4 rounded-lg">Login</button>
                </div>
            </form>
        </div>
    </div>
    <div id="booking-confirmation-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-content w-full max-w-md p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-bold mb-4" data-lang-key="confirmBookingTitle">Confirm Booking</h2>
            <p class="mb-4" data-lang-key="confirmBookingMsg">Please enter the deposit amount to save this cart as a
                booking.</p>
            <div id="booking-modal-summary"></div>
            <form id="booking-confirmation-form">
                <label for="booking-deposit-input" class="block mb-2 mt-4" data-lang-key="deposit">Deposit (EGP)</label>
                <input type="number" id="booking-deposit-input" class="w-full p-2 rounded-lg mb-2" required min="0"
                    step="0.01" placeholder="0.00">
                <div class="flex justify-end space-x-4 mt-6">
                    <button type="button" id="cancel-booking-confirmation-btn"
                        class="btn-secondary py-2 px-4 rounded-lg" data-lang-key="btnCancel">Cancel</button>
                    <button type="submit" class="btn-primary py-2 px-4 rounded-lg" data-lang-key="saveBooking">Save
                        Booking</button>
                </div>
            </form>
        </div>
    </div>
    <div id="booking-edit-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden"></div>
    <div id="employee-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-content w-full max-w-md p-6 rounded-lg shadow-lg">
            <h2 id="employee-modal-title" class="text-2xl font-bold mb-4" data-lang-key="addEmployee">Add New Employee
            </h2>
            <form id="employee-form" class="space-y-4">
                <input type="hidden" id="employee-id-input">
                <div>
                    <label for="employee-name-input" class="block mb-1" data-lang-key="employeeName">Employee
                        Name</label>
                    <input type="text" id="employee-name-input" class="w-full p-2 rounded-lg" required>
                </div>
                <div>
                    <label for="employee-id-input-modal" class="block mb-1" data-lang-key="employeeId">Employee
                        ID</label>
                    <input type="text" id="employee-id-input-modal" class="w-full p-2 rounded-lg" required>
                </div>
                <div>
                    <label for="employee-phone-input" class="block mb-1" data-lang-key="employeePhone">Phone
                        Number</label>
                    <input type="tel" id="employee-phone-input" class="w-full p-2 rounded-lg">
                </div>
                <div class="flex justify-end space-x-4 mt-4">
                    <button type="button" id="cancel-employee-modal-btn" class="btn-secondary py-2 px-4 rounded-lg"
                        data-lang-key="btnCancel">Cancel</button>
                    <button type="submit" class="btn-primary py-2 px-4 rounded-lg" data-lang-key="btnSave">Save</button>
                </div>
            </form>
        </div>
    </div>
    <div id="customer-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-content w-full max-w-md p-6 rounded-lg shadow-lg">
            <h2 id="customer-modal-title" class="text-2xl font-bold mb-4">Add New Customer</h2>
            <form id="customer-form" class="space-y-4">
                <input type="hidden" id="customer-id-input">
                <div>
                    <label for="customer-name-input-modal" class="block mb-1">Name</label>
                    <input type="text" id="customer-name-input-modal" class="w-full p-2 rounded-lg" required>
                </div>
                <div>
                    <label for="customer-phone-input-modal" class="block mb-1">Phone</label>
                    <input type="tel" id="customer-phone-input-modal" class="w-full p-2 rounded-lg" required>
                </div>
                <div>
                    <label for="customer-address-input-modal" class="block mb-1">Address</label>
                    <input type="text" id="customer-address-input-modal" class="w-full p-2 rounded-lg">
                </div>
                <div>
                    <label for="customer-city-input-modal" class="block mb-1">City</label>
                    <input type="text" id="customer-city-input-modal" class="w-full p-2 rounded-lg">
                </div>
                <div class="flex justify-end space-x-4 pt-4">
                    <button type="button" id="cancel-customer-modal-btn"
                        class="btn-secondary py-2 px-4 rounded-lg">Cancel</button>
                    <button type="submit" class="btn-primary py-2 px-4 rounded-lg">Save Customer</button>
                </div>
            </form>
        </div>
    </div>
    <div id="edit-cashier-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-content w-full max-w-sm p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-bold mb-4">Edit Cashier</h2>
            <form id="edit-cashier-form">
                <p id="edit-cashier-sale-id" class="mb-4 text-sm text-gray-500"></p>
                <label for="edit-cashier-select" class="block mb-2">New Cashier</label>
                <select id="edit-cashier-select" class="w-full p-2 rounded-lg mb-4" required></select>
                <div class="flex justify-end space-x-4 mt-4">
                    <button type="button" id="cancel-edit-cashier-btn"
                        class="btn-secondary py-2 px-4 rounded-lg">Cancel</button>
                    <button type="submit" class="btn-primary py-2 px-4 rounded-lg">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Stock Reduction and Defects Modals -->
    <div id="stock-reduction-confirm-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-content w-full max-w-lg p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-bold mb-4" data-lang-key="stockAdjustConfirmTitle">Stock Adjustment Confirmation
            </h2>
            <p id="stock-reduction-confirm-message" class="mb-6"></p>
            <div class="flex justify-end space-x-2">
                <button id="stock-reduction-cancel-btn" class="btn-secondary py-2 px-4 rounded-lg"
                    data-lang-key="cancelOption">Cancel</button>
                <button id="stock-reduction-defective-btn" class="btn-danger py-2 px-4 rounded-lg"
                    data-lang-key="markDefectiveOption">Mark as Defective</button>
                <button id="stock-reduction-deduct-btn" class="btn-primary py-2 px-4 rounded-lg"
                    data-lang-key="deductCostOption">Deduct Cost</button>
            </div>
        </div>
    </div>
    <div id="defective-item-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-content w-full max-w-md p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-bold mb-4" data-lang-key="markAsDefectiveTitle">Mark Item as Defective</h2>
            <p id="defective-item-message" class="mb-4"></p>
            <form id="defective-item-form">
                <div class="mb-4">
                    <label for="defective-reason-input" class="block mb-1" data-lang-key="colDefectReason">Reason for
                        Defect</label>
                    <input type="text" id="defective-reason-input" class="w-full p-2 rounded-lg" required>
                    <div class="mt-4 flex items-center">
                        <input type="checkbox" id="defective-returned-checkbox" class="h-5 w-5 rounded mr-2">
                        <label for="defective-returned-checkbox" data-lang-key="colReturnedStatus">Returned to
                            Supplier</label>
                    </div>
                </div>
                <div class="flex justify-end space-x-4">
                    <button type="button" id="cancel-defective-btn" class="btn-secondary py-2 px-4 rounded-lg"
                        data-lang-key="btnCancel">Cancel</button>
                    <button type="submit" class="btn-danger py-2 px-4 rounded-lg" data-lang-key="btnSaveDefect">Save as
                        Defective</button>
                </div>
            </form>
        </div>
    </div>

    <div id="return-type-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-content w-full max-w-sm p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-bold mb-4" data-lang-key="returnTypeTitle">Return Type</h2>
            <p class="mb-6" data-lang-key="returnTypeMessage">How do you want to handle this return?</p>
            <div class="flex justify-end space-x-2">
                <button id="cancel-return-type-btn" class="btn-secondary py-2 px-4 rounded-lg"
                    data-lang-key="btnCancel">Cancel</button>
                <button id="return-as-defective-btn" class="btn-danger py-2 px-4 rounded-lg"
                    data-lang-key="returnAsDefective">Mark as Defective</button>
                <button id="return-to-stock-btn" class="btn-primary py-2 px-4 rounded-lg"
                    data-lang-key="returnToStock">Normal Return</button>
            </div>
        </div>
    </div>

    <div id="free-delivery-cost-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-content w-full max-w-sm p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-bold mb-4" data-lang-key="freeDelivery">Free Delivery</h2>
            <form id="free-delivery-cost-form">
                <label for="free-delivery-cost-input" class="block mb-2" data-lang-key="freeDeliveryCostPrompt">Please
                    enter the shipping cost you are covering for this free delivery:</label>
                <input type="number" id="free-delivery-cost-input" class="w-full p-2 rounded-lg mb-4" required min="1"
                    step="0.01">
                <div class="flex justify-end space-x-4 mt-4">
                    <button type="button" id="cancel-free-delivery-cost-btn" class="btn-secondary py-2 px-4 rounded-lg"
                        data-lang-key="btnCancel">Cancel</button>
                    <button type="submit" class="btn-primary py-2 px-4 rounded-lg" data-lang-key="btnOK">OK</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Supplier Modals -->
    <div id="supplier-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden"></div>
    <div id="select-supplier-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden"></div>
    <div id="supplier-payment-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden"></div>
    <div id="supplier-defect-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden"></div>
    <div id="supplier-return-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden"></div>
    <div id="shipment-item-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden"></div>

    <!-- [--- إضافة ---] نافذة إنشاء فاتورة المورد الجديدة -->
    <div id="invoice-builder-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-content modal-content-scrollable w-full max-w-4xl p-6 rounded-lg shadow-lg my-8">
            <!-- المحتوى سيتم إضافته هنا لاحقاً بواسطة ui.js -->
        </div>
    </div>

    <!-- [--- إضافة ---] نوافذ منبثقة جديدة لليوميات -->
    <div id="daily-expense-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden"></div>
    <div id="edit-daily-expense-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden"></div>
    <!-- [--- إضافة ---] -->
    <div id="shift-calculation-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden"></div>
    <div id="reconciliation-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden"></div>

    <div id="loader-overlay" class="hidden">
        <div class="loader-spinner"></div>
    </div>

    <script src="renderer.js" type="module"></script>
</body>

</html>